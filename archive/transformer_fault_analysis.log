2025-05-17 10:29:40,640 - INFO - Notebook execution started.
2025-05-17 10:29:40,647 - INFO - Using device: cpu
2025-05-17 10:29:40,799 - INFO - Successfully loaded 'Health index1.csv'. Shape: (470, 16)
2025-05-17 10:29:40,883 - INFO - All critical DGA and Health Index columns are present.
2025-05-17 10:29:40,906 - INFO - Diagnostic functions defined.
2025-05-17 10:29:40,956 - INFO - Calculated Duval gas percentages.
2025-05-17 10:29:40,964 - INFO - Calculated gas ratios and handled NaNs/Infs.
2025-05-17 10:29:41,009 - INFO - Derived initial 'Fault_Type_Raw'.
2025-05-17 10:29:41,011 - INFO - Initial Fault_Type_Raw distribution:
Fault_Type_Raw
T3    182
D1    169
T1     57
T2     38
PD      8
D2      7
NF      5
DT      4
Name: count, dtype: int64
2025-05-17 10:29:41,011 - INFO - Potentially rare classes for merging: ['PD', 'D2', 'DT']
2025-05-17 10:29:41,013 - INFO - Removed rows with 'Error_InvalidInput'. New shape: (470, 26)
2025-05-17 10:29:41,035 - INFO - Using custom_merge_map: {'PD': 'Low_Med_Energy_Discharge', 'D1': 'Low_Med_Energy_Discharge'}
2025-05-17 10:29:41,040 - INFO - Fault_Type distribution after merging:
Fault_Type_Merged
T3                          182
Low_Med_Energy_Discharge    177
T1                           57
T2                           38
D2                            7
NF                            5
DT                            4
Name: count, dtype: int64
2025-05-17 10:29:41,053 - INFO - Label encoder classes: ['D2', 'DT', 'Low_Med_Energy_Discharge', 'NF', 'T1', 'T2', 'T3']
2025-05-17 10:29:41,061 - INFO - Saved final label encoder.
2025-05-17 10:29:41,089 - INFO - Selected 19 features. X shape: (470, 19), y shape: (470,)
2025-05-17 10:29:41,113 - INFO - No missing values in X. Skipping KNNImputer.
2025-05-17 10:29:41,133 - INFO - Applied StandardScaler and saved general scaler.
2025-05-17 10:29:41,166 - INFO - Class distribution before SMOTE:
D2                            7
DT                            4
Low_Med_Energy_Discharge    177
NF                            5
T1                           57
T2                           38
T3                          182
Name: count, dtype: int64
2025-05-17 10:29:41,168 - INFO - Applying SMOTE with k_neighbors=3
2025-05-17 10:29:41,262 - INFO - SMOTE applied. Resampled class distribution:
D2                          182
DT                          182
Low_Med_Energy_Discharge    182
NF                          182
T1                          182
T2                          182
T3                          182
Name: count, dtype: int64
2025-05-17 10:29:41,285 - INFO - Number of classes for model: 7
2025-05-17 10:29:41,329 - INFO - Using SMOTE-resampled data for K-Fold.
2025-05-17 10:29:41,335 - INFO - --- K-Fold Fold 1/5 ---
2025-05-17 10:29:41,375 - INFO - FaultClassifier: input=19, classes=7, h1=128, h2=64, dr=0.3
2025-05-17 10:29:49,907 - INFO - Fold 1 best metrics: Val Acc=0.8824, Val F1(W)=0.8789
2025-05-17 10:29:49,907 - INFO - --- K-Fold Fold 2/5 ---
2025-05-17 10:29:49,918 - INFO - FaultClassifier: input=19, classes=7, h1=128, h2=64, dr=0.3
2025-05-17 10:29:57,530 - INFO - Fold 2 best metrics: Val Acc=0.8471, Val F1(W)=0.8403
2025-05-17 10:29:57,530 - INFO - --- K-Fold Fold 3/5 ---
2025-05-17 10:29:57,533 - INFO - FaultClassifier: input=19, classes=7, h1=128, h2=64, dr=0.3
2025-05-17 10:30:01,259 - INFO - Fold 3 best metrics: Val Acc=0.8471, Val F1(W)=0.8395
2025-05-17 10:30:01,260 - INFO - --- K-Fold Fold 4/5 ---
2025-05-17 10:30:01,262 - INFO - FaultClassifier: input=19, classes=7, h1=128, h2=64, dr=0.3
2025-05-17 10:30:04,895 - INFO - Fold 4: Early stopping at epoch 42
2025-05-17 10:30:04,895 - INFO - Fold 4 best metrics: Val Acc=0.8353, Val F1(W)=0.8281
2025-05-17 10:30:04,896 - INFO - --- K-Fold Fold 5/5 ---
2025-05-17 10:30:04,900 - INFO - FaultClassifier: input=19, classes=7, h1=128, h2=64, dr=0.3
2025-05-17 10:30:08,897 - INFO - Fold 5 best metrics: Val Acc=0.8307, Val F1(W)=0.8263
2025-05-17 10:30:08,899 - INFO - K-Fold Avg Val Acc: 0.8485 ± 0.0181, Avg Val F1(W): 0.8426 ± 0.0190
2025-05-17 10:30:08,957 - INFO - --- Starting Final Model Training ---
2025-05-17 10:30:08,987 - INFO - Final Train: 891, Val: 191, Test: 192
2025-05-17 10:30:09,000 - INFO - Saved final_model_scaler.
2025-05-17 10:30:09,018 - INFO - FaultClassifier: input=19, classes=7, h1=128, h2=64, dr=0.3
2025-05-17 10:30:09,094 - INFO - Final Model - Epoch 1, Train Loss: 1.8911, Val Loss: 1.7881, Val Acc: 0.4450, Val F1(W): 0.3915
2025-05-17 10:30:09,121 - INFO - Saved best final model (Epoch 1), Val Loss: 1.7881
2025-05-17 10:30:09,193 - INFO - Saved best final model (Epoch 2), Val Loss: 1.6231
2025-05-17 10:30:09,260 - INFO - Saved best final model (Epoch 3), Val Loss: 1.4269
2025-05-17 10:30:09,342 - INFO - Saved best final model (Epoch 4), Val Loss: 1.2442
2025-05-17 10:30:09,428 - INFO - Saved best final model (Epoch 5), Val Loss: 1.0856
2025-05-17 10:30:09,511 - INFO - Saved best final model (Epoch 6), Val Loss: 0.9586
2025-05-17 10:30:09,586 - INFO - Saved best final model (Epoch 7), Val Loss: 0.8675
2025-05-17 10:30:09,698 - INFO - Saved best final model (Epoch 8), Val Loss: 0.7961
2025-05-17 10:30:09,792 - INFO - Saved best final model (Epoch 9), Val Loss: 0.7468
2025-05-17 10:30:09,871 - INFO - Saved best final model (Epoch 10), Val Loss: 0.7105
2025-05-17 10:30:09,938 - INFO - Final Model - Epoch 11, Train Loss: 0.7817, Val Loss: 0.6734, Val Acc: 0.7749, Val F1(W): 0.7565
2025-05-17 10:30:09,941 - INFO - Saved best final model (Epoch 11), Val Loss: 0.6734
2025-05-17 10:30:10,026 - INFO - Saved best final model (Epoch 12), Val Loss: 0.6469
2025-05-17 10:30:10,354 - INFO - Saved best final model (Epoch 13), Val Loss: 0.6204
2025-05-17 10:30:10,568 - INFO - Saved best final model (Epoch 14), Val Loss: 0.5994
2025-05-17 10:30:10,704 - INFO - Saved best final model (Epoch 15), Val Loss: 0.5804
2025-05-17 10:30:10,805 - INFO - Saved best final model (Epoch 16), Val Loss: 0.5672
2025-05-17 10:30:10,906 - INFO - Saved best final model (Epoch 17), Val Loss: 0.5506
2025-05-17 10:30:10,987 - INFO - Saved best final model (Epoch 18), Val Loss: 0.5361
2025-05-17 10:30:11,055 - INFO - Saved best final model (Epoch 19), Val Loss: 0.5263
2025-05-17 10:30:11,123 - INFO - Saved best final model (Epoch 20), Val Loss: 0.5183
2025-05-17 10:30:11,186 - INFO - Final Model - Epoch 21, Train Loss: 0.5959, Val Loss: 0.5079, Val Acc: 0.8063, Val F1(W): 0.7943
2025-05-17 10:30:11,189 - INFO - Saved best final model (Epoch 21), Val Loss: 0.5079
2025-05-17 10:30:11,262 - INFO - Saved best final model (Epoch 22), Val Loss: 0.4991
2025-05-17 10:30:11,328 - INFO - Saved best final model (Epoch 23), Val Loss: 0.4866
2025-05-17 10:30:11,396 - INFO - Saved best final model (Epoch 24), Val Loss: 0.4866
2025-05-17 10:30:11,517 - INFO - Saved best final model (Epoch 25), Val Loss: 0.4859
2025-05-17 10:30:11,609 - INFO - Saved best final model (Epoch 26), Val Loss: 0.4746
2025-05-17 10:30:11,684 - INFO - Saved best final model (Epoch 27), Val Loss: 0.4640
2025-05-17 10:30:11,753 - INFO - Saved best final model (Epoch 28), Val Loss: 0.4604
2025-05-17 10:30:11,888 - INFO - Saved best final model (Epoch 29), Val Loss: 0.4590
2025-05-17 10:30:12,137 - INFO - Saved best final model (Epoch 30), Val Loss: 0.4484
2025-05-17 10:30:12,262 - INFO - Final Model - Epoch 31, Train Loss: 0.5109, Val Loss: 0.4441, Val Acc: 0.8168, Val F1(W): 0.8090
2025-05-17 10:30:12,266 - INFO - Saved best final model (Epoch 31), Val Loss: 0.4441
2025-05-17 10:30:12,390 - INFO - Saved best final model (Epoch 32), Val Loss: 0.4406
2025-05-17 10:30:12,488 - INFO - Saved best final model (Epoch 33), Val Loss: 0.4343
2025-05-17 10:30:12,657 - INFO - Saved best final model (Epoch 35), Val Loss: 0.4273
2025-05-17 10:30:12,738 - INFO - Saved best final model (Epoch 36), Val Loss: 0.4222
2025-05-17 10:30:12,808 - INFO - Saved best final model (Epoch 37), Val Loss: 0.4193
2025-05-17 10:30:12,876 - INFO - Saved best final model (Epoch 38), Val Loss: 0.4169
2025-05-17 10:30:12,945 - INFO - Saved best final model (Epoch 39), Val Loss: 0.4167
2025-05-17 10:30:13,009 - INFO - Saved best final model (Epoch 40), Val Loss: 0.4130
2025-05-17 10:30:13,075 - INFO - Final Model - Epoch 41, Train Loss: 0.4816, Val Loss: 0.4179, Val Acc: 0.8115, Val F1(W): 0.8011
2025-05-17 10:30:13,271 - INFO - Saved best final model (Epoch 44), Val Loss: 0.4102
2025-05-17 10:30:13,342 - INFO - Saved best final model (Epoch 45), Val Loss: 0.4058
2025-05-17 10:30:13,475 - INFO - Saved best final model (Epoch 47), Val Loss: 0.3941
2025-05-17 10:30:13,543 - INFO - Saved best final model (Epoch 48), Val Loss: 0.3916
2025-05-17 10:30:13,609 - INFO - Saved best final model (Epoch 49), Val Loss: 0.3909
2025-05-17 10:30:13,683 - INFO - Saved best final model (Epoch 50), Val Loss: 0.3870
2025-05-17 10:30:13,750 - INFO - Final Model - Epoch 51, Train Loss: 0.4402, Val Loss: 0.3830, Val Acc: 0.8482, Val F1(W): 0.8424
2025-05-17 10:30:13,753 - INFO - Saved best final model (Epoch 51), Val Loss: 0.3830
2025-05-17 10:30:14,214 - INFO - Saved best final model (Epoch 58), Val Loss: 0.3819
2025-05-17 10:30:14,281 - INFO - Saved best final model (Epoch 59), Val Loss: 0.3769
2025-05-17 10:30:14,412 - INFO - Final Model - Epoch 61, Train Loss: 0.3933, Val Loss: 0.3804, Val Acc: 0.8429, Val F1(W): 0.8357
2025-05-17 10:30:14,690 - INFO - Saved best final model (Epoch 65), Val Loss: 0.3766
2025-05-17 10:30:14,778 - INFO - Saved best final model (Epoch 66), Val Loss: 0.3761
2025-05-17 10:30:14,920 - INFO - Saved best final model (Epoch 68), Val Loss: 0.3667
2025-05-17 10:30:15,051 - INFO - Saved best final model (Epoch 70), Val Loss: 0.3661
2025-05-17 10:30:15,117 - INFO - Final Model - Epoch 71, Train Loss: 0.3686, Val Loss: 0.3680, Val Acc: 0.8691, Val F1(W): 0.8629
2025-05-17 10:30:15,184 - INFO - Saved best final model (Epoch 72), Val Loss: 0.3637
2025-05-17 10:30:15,645 - INFO - Saved best final model (Epoch 79), Val Loss: 0.3594
2025-05-17 10:30:15,713 - INFO - Saved best final model (Epoch 80), Val Loss: 0.3585
2025-05-17 10:30:15,776 - INFO - Final Model - Epoch 81, Train Loss: 0.3569, Val Loss: 0.3615, Val Acc: 0.8586, Val F1(W): 0.8533
2025-05-17 10:30:15,846 - INFO - Saved best final model (Epoch 82), Val Loss: 0.3576
2025-05-17 10:30:15,983 - INFO - Saved best final model (Epoch 84), Val Loss: 0.3539
2025-05-17 10:30:16,145 - INFO - Saved best final model (Epoch 86), Val Loss: 0.3499
2025-05-17 10:30:16,549 - INFO - Final Model - Epoch 91, Train Loss: 0.3114, Val Loss: 0.3513, Val Acc: 0.8848, Val F1(W): 0.8800
2025-05-17 10:30:16,829 - INFO - Saved best final model (Epoch 95), Val Loss: 0.3493
2025-05-17 10:30:16,961 - INFO - Saved best final model (Epoch 97), Val Loss: 0.3491
2025-05-17 10:30:17,032 - INFO - Saved best final model (Epoch 98), Val Loss: 0.3485
2025-05-17 10:30:17,100 - INFO - Saved best final model (Epoch 99), Val Loss: 0.3438
2025-05-17 10:30:17,167 - INFO - Final Model - Epoch 100, Train Loss: 0.3324, Val Loss: 0.3416, Val Acc: 0.8953, Val F1(W): 0.8928
2025-05-17 10:30:17,170 - INFO - Saved best final model (Epoch 100), Val Loss: 0.3416
2025-05-17 10:30:17,170 - INFO - Final model training completed.
2025-05-17 10:30:17,201 - INFO - --- Evaluating Final Model on Test Set ---
2025-05-17 10:30:17,226 - INFO - Loaded best_fault_analysis_model.pt
2025-05-17 10:30:17,248 - INFO - Test Accuracy: 0.8229, F1(W): 0.8184, F1(M): 0.8187
2025-05-17 10:30:17,261 - INFO - 
Classification Report (Test Set):
                          precision    recall  f1-score   support

                      D2       1.00      1.00      1.00        27
                      DT       0.93      1.00      0.96        27
Low_Med_Energy_Discharge       0.55      0.44      0.49        27
                      NF       1.00      1.00      1.00        28
                      T1       0.70      0.82      0.75        28
                      T2       0.88      0.85      0.87        27
                      T3       0.67      0.64      0.65        28

                accuracy                           0.82       192
               macro avg       0.82      0.82      0.82       192
            weighted avg       0.82      0.82      0.82       192

2025-05-17 10:30:17,761 - INFO - Saved final confusion matrix.
